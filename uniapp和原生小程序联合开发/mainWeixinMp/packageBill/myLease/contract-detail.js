(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packageBill/myLease/contract-detail"],{"1533f":function(e,t,n){"use strict";n.r(t);var r=n("97e3"),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},2846:function(e,t,n){},"3ad8":function(e,t,n){"use strict";n.r(t);var r=n("5f11"),a=n("1533f");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("4c4a");var i=n("f0c5"),s=Object(i["a"])(a["default"],r["b"],r["c"],!1,null,"62affa92",null,!1,r["a"],void 0);t["default"]=s.exports},"4c4a":function(e,t,n){"use strict";var r=n("2846"),a=n.n(r);a.a},"5f11":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r}));var r={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"cff5"))}},a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.houses.length>2&&!e.houseExpanded),r=e.houses.length>2&&e.houseExpanded,a=e.baseInfo.coveredArea?e.baseInfo.coveredArea.toFixed(2):null,o=e.leaseTerms.length,i=0!=o?e.__map(e.leaseTerms,(function(t,n){var r=e.__get_orig(t),a=e.leaseTerms.length,o=t.totalAmount>0?e.fmoney(t.totalAmount):null,i=1==t.contractChargeItemOption&&t.houses&&t.houses.length>0,s=i?t.houses.length>2&&!t.houseExpanded:null,u=i?t.houses.length>2&&t.houseExpanded:null,l=t.houseId.length,c=e.__map(t.contractDiscounts,(function(t,n){var r=e.__get_orig(t),a=e.convertDate(t.beginDate,"."),o=e.convertDate(t.endDate,"."),i=t.houseId.length;return{$orig:r,m1:a,m2:o,g8:i}})),d=t.isIncreaseByYear?e.convertDate(t.increaseDate,"."):null;return{$orig:r,g4:a,m0:o,g5:i,g6:s,g7:u,g9:l,l0:c,m3:d}})):null,s=e.depositTerms.length,u=0!=s?e.__map(e.depositTerms,(function(t,n){var r=e.__get_orig(t),a=e.depositTerms.length,o=t.totalAmount>0?e.fmoney(t.totalAmount):null,i=1==t.contractChargeItemOption&&t.houses&&t.houses.length>0,s=i?t.houses.length>2&&!t.houseExpanded:null,u=i?t.houses.length>2&&t.houseExpanded:null,l=t.houseId.length,c=e.__map(t.contractDiscounts,(function(t,n){var r=e.__get_orig(t),a=e.convertDate(t.beginDate,"."),o=e.convertDate(t.endDate,"."),i=t.houseId.length;return{$orig:r,m5:a,m6:o,g15:i}})),d=t.isIncreaseByYear?e.convertDate(t.increaseDate,"."):null;return{$orig:r,g11:a,m4:o,g12:i,g13:s,g14:u,g16:l,l2:c,m7:d}})):null;e.$mp.data=Object.assign({},{$root:{g0:n,g1:r,g2:a,g3:o,l1:i,g10:s,l3:u}})},o=[]},"97e3":function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n("2eee")),o=r(n("448a")),i=r(n("c973"));function s(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={components:{"item-view":function(){n.e("packageBill/myLease/item-view").then(function(){return resolve(n("d3fe"))}.bind(null,n)).catch(n.oe)}},data:function(){return{baseInfo:{originalContractId:null,beginDate:null,endDate:null,chargeItems:[],houseItems:[],id:0,name:"",number:"",regionId:void 0,remark:"",extraTerm:"",renterId:void 0,phone:"",contractStatus:null,coveredArea:null},leaseTerms:[],depositTerms:[],houses:[],bills:[],otherBills:[],otherTotalAmount:0,id:0,approvalDetail:{},tabIndex:0,canApproval:!1,houseExpanded:!1,refreshContracts:!1}},onLoad:function(e){this.id=e.contractId,this.getData()},methods:{getData:function(){var t=this;return(0,i.default)(a.default.mark((function n(){var r,o,i,u,l;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.showLoading({title:"加载中"}),n.next=3,t.$http.get("/api/v1.0/contract/contract/detail",{id:t.id,verificationPermission:!1});case 3:if(r=n.sent,e.hideLoading(),r){o=r,t.baseInfo.beginDate=t.convertDate(o.beginDate,"."),t.baseInfo.endDate=t.convertDate(o.endDate,"."),t.baseInfo.houseItems=o.houseItems,t.baseInfo.id=o.id,t.baseInfo.name=o.name,t.baseInfo.number=o.number,t.baseInfo.regionId=o.regionId,t.baseInfo.remark=o.remark,t.baseInfo.extraTerm=o.extraTerm,t.baseInfo.renterId=o.renterId,t.baseInfo.phone=o.phone,t.baseInfo.originalContractId=o.originalContractId,t.baseInfo.contractStatus=o.contractStatus,i=s(o.chargeItems);try{for(i.s();!(u=i.n()).done;)l=u.value,l.beginDate=t.convertDate(l.beginDate,"."),l.endDate=t.convertDate(l.endDate,"."),l.beginDateObj=new Date(l.beginDate),l.endDateObj=new Date(l.endDate),l.fixedAmount=l.money,l.isDeposit?t.depositTerms.push(l):t.leaseTerms.push(l)}catch(a){i.e(a)}finally{i.f()}t.getHouses(t.id)}case 6:case"end":return n.stop()}}),n)})))()},getHouses:function(e){var t=this;return(0,i.default)(a.default.mark((function n(){var r,o,i,u,l,c;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("/api/v1.0/contract/Contract/app/".concat(e,"/houses"));case 2:if(r=n.sent,r){o=r,t.houses=o,i=0,u=s(o);try{for(u.s();!(l=u.n()).done;)c=l.value,i+=c.coveredArea?c.coveredArea:0}catch(a){u.e(a)}finally{u.f()}t.baseInfo.coveredArea=i,t.leaseTerms.length>0&&t.leaseTerms.forEach((function(e){e.houses=t.houses.filter((function(t){return e.houseId.indexOf(t.id)>-1}))})),t.depositTerms.length>0&&t.depositTerms.forEach((function(e){e.houses=t.houses.filter((function(t){return e.houseId.indexOf(t.id)>-1}))})),t.getBills(e)}case 4:case"end":return n.stop()}}),n)})))()},getBills:function(e){var t=this;return(0,i.default)(a.default.mark((function n(){var r,i,u,l,c,d,f,h,m,g,p,b,v;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$http.get("/api/v1.0/contract/Contract/app/".concat(e,"/billDetails"));case 2:if(r=n.sent,r){i=r,u=[],l=s(i);try{for(l.s();!(c=l.n()).done;){d=c.value,f=s(d.data);try{for(f.s();!(h=f.n()).done;)m=h.value,m.beginDate=t.convertDate(m.beginDate,"."),m.endDate=t.convertDate(m.endDate,"."),m.beginDateObj=new Date(m.beginDate),m.endDateObj=new Date(m.endDate),u.push(m)}catch(a){f.e(a)}finally{f.f()}}}catch(a){l.e(a)}finally{l.f()}t.bills=u,t.leaseTerms.length>0&&(t.leaseTerms.forEach((function(e){var n=u.filter((function(t){return t.chargeItemId==e.chargeItemId&&t.beginDateObj>=e.beginDateObj&&t.beginDateObj<=e.endDateObj}));n=1==e.contractChargeItemOption?n.filter((function(t){return e.houseId.indexOf(t.resourceId)>-1})):n.filter((function(e){return null==e.resourceId})),n=0==e.expenser?n.filter((function(e){return e.customerId==t.baseInfo.renterId})):n.filter((function(e){return e.customerId!=t.baseInfo.renterId}));var r,o=0,i=s(n);try{for(i.s();!(r=i.n()).done;){var l=r.value;o+=l.actualAmount,l.isHandled=!0}}catch(a){i.e(a)}finally{i.f()}e.totalAmount=o,e.bills=n})),t.leaseTerms=(0,o.default)(t.leaseTerms)),t.depositTerms.length>0&&(t.depositTerms.forEach((function(e){var n=u.filter((function(t){return t.chargeItemId==e.chargeItemId&&t.beginDateObj>=e.beginDateObj&&t.beginDateObj<=e.endDateObj}));n=1==e.contractChargeItemOption?n.filter((function(t){return e.houseId.indexOf(t.resourceId)>-1})):n.filter((function(e){return null==e.resourceId})),n=0==e.expenser?n.filter((function(e){return e.customerId==t.baseInfo.renterId})):n.filter((function(e){return e.customerId!=t.baseInfo.renterId}));var r,o=0,i=s(n);try{for(i.s();!(r=i.n()).done;){var l=r.value;o+=l.actualAmount,l.isHandled=!0}}catch(a){i.e(a)}finally{i.f()}e.totalAmount=o,e.bills=n})),t.depositTerms=(0,o.default)(t.depositTerms)),t.otherBills=u.filter((function(e){return!e.isHandled})),g=0,p=s(t.otherBills);try{for(p.s();!(b=p.n()).done;)v=b.value,g+=v.actualAmount}catch(a){p.e(a)}finally{p.f()}t.otherTotalAmount=g}case 4:case"end":return n.stop()}}),n)})))()},convertDate:function(e,t){var n=new Date(e),r=t||"年",a=t||"月",o=t?"":"日",i=n.getMonth()+1,s=n.getDate();i<10&&(i="0".concat(i)),s<10&&(s="0".concat(s));var u=n.getFullYear()+r+i+a+s+o;return u},fmoney:function(e,t){t=t>0&&t<=20?t:2,e=parseFloat((e+"").replace(/[^\d\.-]/g,"")).toFixed(t)+"";for(var n=e.split(".")[0].split("").reverse(),r=e.split(".")[1],a="",o=0;o<n.length;o++)a+=n[o]+((o+1)%3==0&&o+1!=n.length?",":"");return a.split("").reverse().join("")+"."+r},expandHouses:function(e){this.houseExpanded=e},expandTermHouses:function(e,t,n){"deposit"==e?(this.depositTerms[t].houseExpanded=n,this.depositTerms=(0,o.default)(this.depositTerms)):(this.leaseTerms[t].houseExpanded=n,this.leaseTerms=(0,o.default)(this.leaseTerms))},viewBills:function(t,n,r){var a=t>0;if(a){var o=this.leaseTerms.map((function(e){return{totalAmount:e.totalAmount,bills:e.bills,chargeItemName:e.chargeItemName,expanded:!1}})),i=this.depositTerms.map((function(e){return{totalAmount:e.totalAmount,bills:e.bills,chargeItemName:e.chargeItemName,expanded:!1}}));"deposit"==n?i[r].expanded=!0:o[r].expanded=!0;var s=o.concat(i);0!=this.otherBills.length&&s.push({totalAmount:this.otherTotalAmount,bills:this.otherBills,chargeItemName:"其他费用",expanded:!1}),e.navigateTo({url:"./contract-bills"}),setTimeout((function(){e.$emit("go_to_view_contract_bills",{contractBills:s})}),500)}},contractClick:function(){e.navigateTo({url:"/packageBill/bill/bill?isContactBill=true&contractId=".concat(this.id)})}}};t.default=l}).call(this,n("543d")["default"])},fb59:function(e,t,n){"use strict";(function(e,t){var r=n("4ea4");n("895d");r(n("66fd"));var a=r(n("3ad8"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["fb59","common/runtime","common/vendor"]]]);