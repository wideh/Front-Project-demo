require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packageDecoration/new/new"],{"0301":function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i}));var i={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"cff5"))},userPrivacy:function(){return n.e("components/userPrivacy/userPrivacy").then(n.bind(null,"594f"))}},o=function(){var e=this.$createElement,t=(this._self._c,this.imgs.length);this.$mp.data=Object.assign({},{$root:{g0:t}})},r=[]},"3cbd":function(e,t,n){"use strict";(function(e,i){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("7504")),a=o(n("5f22")),c={components:{uniSegmentedControl:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-segmented-control/uni-segmented-control").then(function(){return resolve(n("3f52"))}.bind(null,n)).catch(n.oe)},uniIcons:function(){Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(function(){return resolve(n("1533"))}.bind(null,n)).catch(n.oe)},userPrivacy:function(){n.e("components/userPrivacy/userPrivacy").then(function(){return resolve(n("594f"))}.bind(null,n)).catch(n.oe)}},data:function(){this.getDate({format:!0});return{imgs:[],memo:"",userId:"",textareaMaxLength:200,textareaWordCount:0,maxUploadImgLength:1,isPublicArea:!1,roomDetail:"",startTs:"",endTs:"",roomId:null,companyDirectorCardno:"",companyDirectorName:"",companyDirectorPhone:"",companyStaffCount:"",companyName:"",companyAddress:"",companyQualificationList:["甲级","乙级","丙级"],index:"",changeStructure:0,changeDevice:0,decorateType:2,changeOuter:0,companyQualification:"",applyPhone:"",applyUserName:"",appluUserType:"",buildingArea:"",availableArea:"",building:"",district:"",sourceIds:"",status:0,sourcePlatform:1,fileUrl:"",fileName:"",customerId:"",recordSvg:a.default,showPrivacy:!1}},onLoad:function(t){var n=this;e.onNeedPrivacyAuthorization&&e.onNeedPrivacyAuthorization((function(e,t){n.showPrivacy=!0,n.resolvePrivacyAuthorization=e})),i.removeStorageSync("resourceZX")},computed:{startDate:function(){return this.getDate("start")}},onShow:function(){var e=this,t=i.getStorageSync(e.$config.storageKeys.user);if(t){e.userId=t.userId;var n=i.getStorageSync("resourceZX");n?(console.log("resource: ",n),e.customerId=n.customerId,e.roomId=n.resourceId,e.roomDetail=n.text,e.appluUserType=n.isTenant?"租户":"业主",e.availableArea=n.usedArea,e.buildingArea=n.coveredArea,e.building=n.building,e.district=n.district,e.applyPhone=n.customerPhone,e.applyUserName=n.customerName,e.$httpDec.get("/wuye/getRoomByCustomer?customerId=".concat(n.customerId,"&houseId=").concat(n.resourceId)).then((function(t){if(t.data){var n=t.data;e.applyPhone=n.customerPhone,e.applyUserName=n.customerName,e.sourceIds=n.resourceIds}})).catch((function(e){console.log(e)}))):(e.roomId="",e.roomDetail="",e.availableArea="",e.buildingArea="",e.sourceIds="")}else i.showModal({title:"提示",content:"请先登录",showCancel:!1,success:function(e){i.switchTab({url:"../../pages/me/me"})}})},methods:{agreePrivacy:function(){this.showPrivacy=!1,this.resolvePrivacyAuthorization({buttonId:"agree-btn",event:"agree"})},disagreePrivacy:function(){this.showPrivacy=!1},getDate:function(e){var t=new Date,n=t.getFullYear(),i=t.getMonth()+1,o=t.getDate();return"start"===e&&(n=n),i=i>9?i:"0"+i,o=o>9?o:"0"+o,"".concat(n,"-").concat(i,"-").concat(o)},selectResource:function(){this.isPublicArea?(i.removeStorageSync(this.$config.positionKeys.area),i.removeStorageSync(this.$config.positionKeys.building),i.removeStorageSync(this.$config.positionKeys.unit),i.navigateTo({url:"../../position/position?targetKey="+this.$config.positionKeys.unit})):i.navigateTo({url:"../select/room-and-parking/room-and-parking?selectType=room&&customerId="+this.customerId})},validateId:function(){if(this.companyDirectorCardno&&!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(this.companyDirectorCardno))return this.error("请输入正确的身份证号码"),this.companyDirectorCardno="",!1},validatePhone:function(){if(this.companyDirectorPhone&&!/^1[34578]\d{9}$/.test(this.companyDirectorPhone))return this.error("请输入正确的手机号码"),this.companyDirectorPhone="",!1},validateTime:function(){if(new Date(this.startTs).getTime()>new Date(this.endTs).getTime())return this.error("装修开始日期应早于结束日期"),this.endTs="",!1},RadioChange_decorateType:function(e){this.decorateType=e.detail.value},radioChange_Outer:function(e){this.changeOuter=e.detail.value},radioChange_Structure:function(e){this.changeStructure=e.detail.value},radioChange_Device:function(e){this.changeDevice=e.detail.value},goTohistory:function(){i.redirectTo({url:"../history/history?userId="+this.userId+"&isApply=true"})},bindstartTsChange:function(e){this.startTs=e.target.value;var t=this.validateTime();0==t&&(this.startTs="")},bindendTsChange:function(e){this.endTs=e.target.value;var t=this.validateTime();0==t&&(this.endTs="")},bindPickerChange:function(e){this.index=e.target.value,this.companyQualification=this.companyQualificationList[e.target.value]},descInput:function(){this.textareaWordCount=this.memo.length},uploadImg:function(){var e=this,t=e.maxUploadImgLength-e.imgs.length;t>0&&i.chooseImage({count:t,sizeType:["original","compressed"],success:function(t){var n=e.imgs.concat(t.tempFilePaths);e.imgs=n;var o=t.tempFiles[0].path;e.fileName=o.substring(o.lastIndexOf("/")+1);var a=i.getStorageSync(r.default.storageKeys.token);i.uploadFile({url:e.$config.apiBaseUrl+"/hfle/v1/files/multipart",filePath:e.imgs[0],name:"file",formData:{filename:e.fileName,bucketName:"public",directory:"hpfm05"},header:{"Content-Type":"multipart/form-data",Authorization:a.token_type+" "+a.access_token},success:function(t){e.fileUrl=t.data},fail:function(t){return e.error("上传图片失败，请重新上传"),!1}})}})},actionSheetTap:function(e){var t=e,n=this;i.showActionSheet({itemList:["删除","预览"],success:function(e){0==e.tapIndex&&(n.deleteImg(t),n.fileName="",n.fileUrl=""),1==e.tapIndex&&i.previewImage({current:t,urls:n.imgs})}})},deleteImg:function(e){this.imgs.splice(e,1)},error:function(e){i.showToast({title:e||"异常",icon:"none"})},clearInfomartion:function(){this.imgs=[],this.memo="",this.startTs="",this.endTs="",this.roomDetail="",this.companyDirectorCardno="",this.companyDirectorName="",this.companyDirectorPhone="",this.companyStaffCount="",this.companyName="",this.companyAddress="",this.changeStructure=0,this.changeDevice=0,this.decorateType=2,this.changeOuter=0,this.index="",this.companyQualification="",this.building="",this.district="",this.fileName="",this.fileUrl="",i.removeStorageSync("resourceZX")},validate:function(){var e=this;return e.roomId?e.startTs?e.endTs?!(e.fileName&&!e.fileUrl)||(e.error("等待图片上传"),!1):(e.error("请输入结束日期"),!1):(e.error("请输入开始日期"),!1):(e.error("请选择房间"),!1)},submit:function(){var e=this,t=[];e.fileUrl&&(t=[{fileName:e.fileName,fileUrl:e.fileUrl,entitySource:1}]);var n=e.sourceIds?e.sourceIds.filter((function(e){return null!==e&&void 0!==e})):[];console.log("currentSourceIds",n);var o={userId:e.userId,sourceIds:"["+n.toString()+"]",applyUserId:e.customerId,applyUserName:e.applyUserName+(e.appluUserType?"(".concat(e.appluUserType,")"):""),applyPhone:e.applyPhone,startTs:+new Date(e.formatmyDate(e.startTs)),endTs:+new Date(e.formatmyDate(e.endTs)),changeStructure:e.changeStructure,changeOuter:e.changeOuter,changeDevice:e.changeDevice,decorateType:e.decorateType,memo:e.memo,attachments:t,roomId:e.roomId,roomCode:e.roomDetail,buildingArea:e.buildingArea,availableArea:e.availableArea,district:e.district,building:e.building,status:e.status,sourcePlatform:e.sourcePlatform,miniProgramUserId:e.userId};e.validate()&&this.$httpDec.request("/decorateApply",o,{method:"POST"}).then((function(t){null!=t&&"请求成功"==t.message?(e.clearInfomartion(),i.navigateTo({url:"../new-success/new-success"})):null!=t&&"当前时间段内已存在装修申请"==t.message&&i.showToast({title:"当前时间段已有装修申请",duration:2e3,icon:"none"})})).catch((function(e){})).finally((function(){}))},formatmyDate:function(e){return this.$formatmyDate(e)}}};t.default=c}).call(this,n("bc2e")["default"],n("543d")["default"])},"81bb":function(e,t,n){"use strict";n.r(t);var i=n("0301"),o=n("c9e3");for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("efa66");var a=n("f0c5"),c=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=c.exports},"9a91":function(e,t,n){},c9e3:function(e,t,n){"use strict";n.r(t);var i=n("3cbd"),o=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=o.a},eba4:function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("895d");i(n("66fd"));var o=i(n("81bb"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(o.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},efa66:function(e,t,n){"use strict";var i=n("9a91"),o=n.n(i);o.a}},[["eba4","common/runtime","common/vendor","packageDecoration/common/vendor"]]]);