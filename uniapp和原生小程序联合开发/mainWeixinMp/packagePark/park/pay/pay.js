require('../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packagePark/park/pay/pay"],{"3d3f":function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){}));var n=function(){var t=this.$createElement,a=(this._self._c,(this.amount/100).toFixed(2)),e=(this.amount/100).toFixed(2);this.$mp.data=Object.assign({},{$root:{g0:a,g1:e}})},o=[]},"952e":function(t,a,e){},"97ad":function(t,a,e){"use strict";(function(t){var n=e("4ea4");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;n(e("a8ea"));var o=n(e("7504")),i=n(e("60e9")),r={data:function(){return{amount:"",plateNo:"",parkName:"",enCrossTime:"",parkTime:"",originalAmount:"",discountAmount:"",remainSec:30,footerData:null,carInfo:"",appCode:null,goodsTotalFee:0,bizNotifyUrl:"",tenantId:o.default.tenantId,interval:null}},computed:{displayMins:function(){return this.parkTime?parseInt(this.parkTime/60)+"小时"+this.parkTime%60+"分钟":""},displayRemainMin:function(){var t=parseInt(this.remainSec/60);return t<10?"0"+t:t+""},displayRemainSec:function(){var t=this.remainSec%60;return t<10?"0"+t:t+""}},onLoad:function(t){console.log("onload....");var a=this;a.carInfo=JSON.parse(t.carInfo),a.parkName=a.carInfo.parkName,a.plateNo=a.carInfo.plateNo,a.enCrossTime=a.carInfo.enCrossTime,a.parkTime=a.carInfo.parkTime,a.amount=a.carInfo.amount,a.parkBillOrder=a.carInfo.parkBillOrder,a.appCode=a.carInfo.appCode,a.bizNotifyUrl=a.carInfo.payCallbackUrl,this.startInterval()},onUnload:function(){this.stopInterval()},methods:{startInterval:function(){var a=this;this.interval=setInterval((function(){a.remainSec<=0?(clearInterval(a.interval),t.showModal({title:"订单支付超时",content:"请重新查询缴费金额",showCancel:!1,confirmText:"重新结算",confirmColor:"#000000",success:function(a){t.navigateBack({delta:1})}})):a.remainSec--}),1e3)},stopInterval:function(){clearInterval(this.interval)},onBtnPayDone:function(){t.navigateBack({delta:1})},onBtnPayClick:function(){var a={tenantId:this.tenantId,appCode:this.appCode,channelCode:"WECHAT_MP",goodsList:[{goodsName:"车牌"+this.plateNo+"临停缴费",goodsCode:"LTJF",goodsFee:this.amount}],orderDescribe:"临停缴费",goodsTotalFee:this.amount,sourceBiz:"NOVA_PARK",bizNotifyUrl:this.bizNotifyUrl};t.showLoading({title:"加载中"}),this.stopInterval();var e=this;this.$httpPark.request(o.default.apiBaseUrl+"/npay/v1/unifiedOrder",a,{method:"POST"}).then((function(a){if(console.log("res: ",a),a)if(1==a.failed)t.showToast({title:"发起支付失败",icon:"none"}),e.startInterval();else{var n=a.params;t.requestPayment({provider:"wxpay",timeStamp:n.timeStamp,signType:n.signType,package:n.package,paySign:n.paySign,nonceStr:n.nonceStr,success:function(a){e.stopInterval(),t.redirectTo({url:"./success/success?plateNo=".concat(e.plateNo,"&payTime=").concat((0,i.default)().format("YYYY-MM-DD HH:mm"))})},fail:function(a){console.log("v: ",a);var n=a.errMsg;if(e.startInterval(),n&&n.includes("cancel"))return t.showToast({title:"支付取消",icon:"none"});t.showToast({title:"支付失败",icon:"none"})}})}})).finally((function(){return t.hideLoading()}))}}};a.default=r}).call(this,e("543d")["default"])},bd4b:function(t,a,e){"use strict";e.r(a);var n=e("3d3f"),o=e("f28d");for(var i in o)["default"].indexOf(i)<0&&function(t){e.d(a,t,(function(){return o[t]}))}(i);e("f212");var r=e("f0c5"),c=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,"0ea7abaa",null,!1,n["a"],void 0);a["default"]=c.exports},ea31:function(t,a,e){"use strict";(function(t,a){var n=e("4ea4");e("895d");n(e("66fd"));var o=n(e("bd4b"));t.__webpack_require_UNI_MP_PLUGIN__=e,a(o.default)}).call(this,e("bc2e")["default"],e("543d")["createPage"])},f212:function(t,a,e){"use strict";var n=e("952e"),o=e.n(n);o.a},f28d:function(t,a,e){"use strict";e.r(a);var n=e("97ad"),o=e.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){e.d(a,t,(function(){return n[t]}))}(i);a["default"]=o.a}},[["ea31","common/runtime","common/vendor","packagePark/common/vendor"]]]);