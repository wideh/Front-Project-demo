(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packagePlace/home/home"],{"0241":function(t,e,n){"use strict";n.r(e);var a=n("b00d"),r=n("51a3");for(var i in r)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(i);n("1ba8");var o=n("f0c5"),c=Object(o["a"])(r["default"],a["b"],a["c"],!1,null,"1cc77721",null,!1,a["a"],void 0);e["default"]=c.exports},"1ba8":function(t,e,n){"use strict";var a=n("9f9d"),r=n.n(a);r.a},"51a3":function(t,e,n){"use strict";n.r(e);var a=n("6b91"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=r.a},"6b91":function(t,e,n){"use strict";(function(t){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(n("448a")),i=a(n("9523")),o=a(n("cfcb"));function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){(0,i.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var u={name:"placeReserve",components:{selectTime:function(){n.e("packagePlace/components/select-time").then(function(){return resolve(n("c102"))}.bind(null,n)).catch(n.oe)},inputNumber:function(){n.e("packagePlace/components/input-number").then(function(){return resolve(n("5dac"))}.bind(null,n)).catch(n.oe)},pageStatusBar:function(){n.e("components/page-status-bar/page-status-bar").then(function(){return resolve(n("9cf9"))}.bind(null,n)).catch(n.oe)}},data:function(){return{option:{},titleContainerHeight:0,navigationBarTitle:"场所预约",regionList:[],categoryInfo:{},currentRegion:{},imgUrl:"",formData:{regionId:0,regionName:"",date:"",dateStr:"",week:"",num:1,hours:3,startTime:"",endTime:""},rangeTime:["08:00","21:00"],loading:!1,searchNoData:!1,hoursMin:3,hoursMax:10,disabledStart:"2023-09-01",disabledEnd:"2023-09-08",weekList:Object.freeze(["周日","周一","周二","周三","周四","周五","周六"])}},onLoad:function(e){this.option=e;var n=t.getSystemInfoSync();"android"==n.platform?this.titleContainerHeight=48:this.titleContainerHeight=44},onShow:function(){var e=this;this.formData={regionId:0,regionName:"",date:"",dateStr:"",week:"",num:1,hours:3,startTime:"",endTime:""},this.getRegionInfo(this.option.categoryId),this.getCategoryInfo(this.option.categoryId),this.$nextTick((function(){e.$refs.inputNumber1.inputValue=1}));var n=t.getStorageSync("community");this.disabledStart=this.$timeFormat(),this.currentRegion=n,this.formData=s(s({},this.formData),{},{regionId:n.id,regionName:n&&n.text?n.text:"请选择管理区",date:this.$timeFormat(),dateStr:this.$timeFormat(null,"mm月dd日"),week:this.weekList[(new Date).getDay()]})},methods:{$timeFormat:o.default,getCategoryInfo:function(t){var e=this;this.$httpOrder.get("/category/".concat(t)).then((function(t){e.categoryInfo=t;var n=t.reservationStart,a=t.reservationEnd,r=t.reservationDays,i=t.pic,o=t.reservationDuration;e.imgUrl=i,e.rangeTime=[n,a],e.hoursMin=o,e.hoursMax=Number(a.split(":")[0])-Number(n.split(":")[0]),e.disabledEnd=e.$timeFormat((new Date).getTime()+24*r*60*60*1e3),e.formData.hours=o,e.$refs.inputNumber.inputValue=o}))},getRegionInfo:function(t){var e=this;this.$httpOrder.get("/prod/getRoomRegionListByCategory/".concat(t)).then((function(t){if(Array.isArray(t)&&t.length){var n=t.reduce((function(t,e){return t.find((function(t){return t.id===e.id}))?t:[].concat((0,r.default)(t),[e])}),[]);e.regionList=n.map((function(t){return{key:t.id,value:t.name}}));var a=e.regionList.find((function(t){return t.key===e.currentRegion.id}));e.formData=s(s({},e.formData),{},a?{regionId:e.currentRegion.id,regionName:e.currentRegion.text}:{regionId:e.regionList[0].key,regionName:e.regionList[0].value})}}))},onClickBack:function(){t.navigateBack()},placeChange:function(t){this.searchNoData=!1;var e=this.regionList[Number(t.detail.value)];this.formData.regionName=e.value,this.formData.regionId=e.key},dateChange:function(t){this.searchNoData=!1;var e=t.detail.value;this.formData=s(s({},this.formData),{},{startTime:"",endTime:"",date:e,dateStr:this.$timeFormat(new Date(e).getTime(),"mm月dd日"),week:this.weekList[new Date(e).getDay()]})},openTimeRangeSelect:function(){this.$refs.selectTime.show()},handleSearch:function(){var e=this;this.loading=!0;var n=this.formData,a=n.startTime,r=n.endTime,i=n.date,o=n.num,c=n.hours;if(!a||!r)return t.showToast({title:"请选择预约开始时间",duration:1500,icon:"none"}),void(this.loading=!1);var s={categoryId:this.option.categoryId,appointmentTimeStart:"".concat(i," ").concat(a,":00"),appointmentTimeEnd:"".concat(i," ").concat(r,":00"),personCount:o,regionId:this.formData.regionId};this.$httpOrder.post("/prod/getAvailableRoomProd",s).then((function(n){if(n){e.searchNoData=!1;var a="?categoryId="+s.categoryId+"&appointmentTimeStart="+s.appointmentTimeStart+"&appointmentTimeEnd="+s.appointmentTimeEnd+"&personCount="+s.personCount+"&regionId="+s.regionId+"&num="+o+"&hours="+c+"&unitHours="+e.hoursMin+"&earlyDays="+e.categoryInfo.reservationDays;t.navigateTo({url:"/packagePlace/prod-info/prod-info"+a})}else e.searchNoData=!0})).finally((function(){e.loading=!1}))},selectTimeChange:function(t){this.formData.startTime=t[0],this.formData.endTime=t[1]},hoursChange:function(){this.formData=s(s({},this.formData),{},{startTime:"",endTime:""})}}};e.default=u}).call(this,n("543d")["default"])},"9f9d":function(t,e,n){},b00d:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var a={pageStatusBar:function(){return n.e("components/page-status-bar/page-status-bar").then(n.bind(null,"9cf9"))}},r=function(){var t=this.$createElement;this._self._c},i=[]},f0a1:function(t,e,n){"use strict";(function(t,e){var a=n("4ea4");n("895d");a(n("66fd"));var r=a(n("0241"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["f0a1","common/runtime","common/vendor"]]]);