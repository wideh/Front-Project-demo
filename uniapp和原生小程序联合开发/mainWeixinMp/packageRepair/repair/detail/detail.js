require('../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packageRepair/repair/detail/detail"],{3883:function(t,e,n){"use strict";n.r(e);var o=n("3b56"),a=n("e86a");for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);n("5de8");var c=n("f0c5"),s=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=s.exports},3940:function(t,e,n){},"3b56":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,n=(t._self._c,t.imgs.length),o=t.hasComment?null:t.__map(t.processHistorys,(function(e,n){var o=t.__get_orig(e),a=t.processHistorys.length,r=n==a-1?t.getTimeStr(e.date):null,c=n==a-1?t.getDateStr(e.date):null,s=n!=a-1?t.getTimeStr(e.date):null,i=n!=a-1?t.getDateStr(e.date):null;return{$orig:o,g1:a,m0:r,m1:c,m2:s,m3:i}}));t.$mp.data=Object.assign({},{$root:{g0:n,l0:o}})},a=[]},"5c9f":function(t,e,n){"use strict";(function(t,e){var o=n("4ea4");n("895d");o(n("66fd"));var a=o(n("3883"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"5de8":function(t,e,n){"use strict";var o=n("3940"),a=n.n(o);a.a},"9a5d":function(t,e,n){"use strict";(function(t){var o=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n("2eee")),r=o(n("c973")),c=o(n("7504")),s={components:{uniTag:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-tag/uni-tag").then(function(){return resolve(n("f7b5"))}.bind(null,n)).catch(n.oe)},customFooter:function(){n.e("components/custom-footer/custom-footer").then(function(){return resolve(n("7d39"))}.bind(null,n)).catch(n.oe)}},data:function(){return{apiHeader:c.default.apiWYStaticResUrl,question:"家中厨房水管爆裂，家中客厅灯泡不能用了。",voucherNo:"",areaStr:"",place:"",customerName:"",phone:"",contactPhone:"",appointmentTime:"",status:1,statusStr:"",isExpand:!1,imgs:[],hasComment:!1,comments:[],level:{level:1,url:"https://pms-statics.oss-cn-shenzhen.aliyuncs.com/wechat-static/door/good-1.png",text:"好评"},commentContent:"",workOrderId:0,processHistorys:[],footerData:null}},onLoad:function(e){console.log(e);var n=this;e&&e.id&&(n.hasComment="true"==e.hasComment,n.workOrderId=e.id,n.getDetailDataBy(e.id));var o=t.getStorageSync(n.$config.storageKeys.community);n.$http.get("/api/v2.0/weChat/regions/".concat(o.id,"/phone")).then((function(t){n.contactPhone=t}))},onShow:function(){this.getFooterData()},methods:{callPhone:function(){var e=this;return new Promise((function(n,o){t.showModal({title:"确认拨打该电话吗？",content:e.contactPhone,success:function(t){t.confirm?n(!0):n(!1)}})}))},contact:function(){var e=this;return(0,r.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!e.contactPhone){n.next=7;break}return n.next=3,e.callPhone();case 3:if(!n.sent){n.next=5;break}t.makePhoneCall({phoneNumber:e.contactPhone});case 5:n.next=8;break;case 7:t.showToast({icon:"none",title:"亲爱的业主：电话号码修改中，暂时无法显示，请耐心等待！",duration:2e3});case 8:case"end":return n.stop()}}),n)})))()},actionSheetTap:function(e){var n=e,o=this;t.showActionSheet({itemList:["预览"],success:function(e){if(0==e.tapIndex){console.log(o.imgs);var a=[];o.imgs.forEach((function(t){a.push(o.$tool.image.getHttpUrl(t.url))})),console.log(a),t.previewImage({current:n,urls:a})}}})},getDateStr:function(t){return this.$tool.date.format(t,"yyyy.MM.dd")},getTimeStr:function(t){return this.$tool.date.format(t,"hh:mm")},reminder:function(){this.$http.request("/api/v2.0/weChat/repairs/".concat(this.workOrderId,"/urge"),null,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"PUT"}).then((function(e){console.log(e),t.showToast({title:"催单成功！",icon:"none"})})).catch((function(e){console.log(e),t.showToast({title:e.message,icon:"none"})}))},getDetailDataBy:function(e){var n=this;n.$http.get("/api/v2.0/weChat/repairs/".concat(e,"/isReturn")).then((function(t){if(t){console.log(t),n.phone=t.phone,n.question=t.detail,n.voucherNo=t.voucherNo,n.areaStr=t.areaStr,n.place=t.place,n.customerName=t.customerName,n.appointmentTime=n.$tool.date.format(t.appointmentTime,"yyyy-MM-dd hh:mm:ss"),n.imgs=t.attachments,n.status=t.status,n.statusStr=t.statusStr,n.processHistorys=t.processHistorys,n.comments=t.evaluateStr;var e="";e=0==t.grade?"https://pms-statics.oss-cn-shenzhen.aliyuncs.com/wechat-static/door/good-1.png":1==t.grade?"https://pms-statics.oss-cn-shenzhen.aliyuncs.com/wechat-static/door/normal-1.png":"https://pms-statics.oss-cn-shenzhen.aliyuncs.com/wechat-static/door/bad-1.png";var o={level:t.grade,url:e,text:t.gradeStr};n.level=o,n.commentContent=t.commentContent}})).catch((function(e){console.log(e),t.showToast({title:e.message,icon:"none"})}))},getFooterData:function(){var t=this;return(0,r.default)(a.default.mark((function e(){var n;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$footerConfig.get();case 2:n=e.sent,t.footerData=n;case 4:case"end":return e.stop()}}),e)})))()}}};e.default=s}).call(this,n("543d")["default"])},e86a:function(t,e,n){"use strict";n.r(e);var o=n("9a5d"),a=n.n(o);for(var r in o)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(r);e["default"]=a.a}},[["5c9f","common/runtime","common/vendor"]]]);