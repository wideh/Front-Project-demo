(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["packageWM/sale-activity/history-sale-activity-detail"],{"0d19":function(t,n,i){"use strict";i.r(n);var e=i("8a7d"),o=i("bb80");for(var s in o)["default"].indexOf(s)<0&&function(t){i.d(n,t,(function(){return o[t]}))}(s);i("4c9d");var a=i("f0c5"),c=Object(a["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],void 0);n["default"]=c.exports},"0d99":function(t,n,i){},"4c9d":function(t,n,i){"use strict";var e=i("0d99"),o=i.n(e);o.a},"5aa3":function(t,n,i){"use strict";(function(t,e){var o=i("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=o(i("2eee")),a=o(i("c973")),c={data:function(){return{activityId:null,type:0,skip:0,take:10,dishesTypes:[],dishes:[],totalAmount:0,featch:!0,selectedDishes:[],phoneNumber:"",computedNum:[],Bookings:[],nickNames:"",footerData:null}},onLoad:function(n){this.activityId=n.activityId,this.onClickSearch(this.type),this.phoneNumber=t.getStorageSync("phoneNumber")},onPullDownRefresh:function(){this.dishes=[],this.onClickSearch(),e.stopPullDownRefresh()},onReachBottom:function(){this.featch&&(this.skip+=10,this.onClickSearch())},onShow:function(){this.getFooterData()},methods:{getFooterData:function(){var t=this;return(0,a.default)(s.default.mark((function n(){var i;return s.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$footerConfig.get();case 2:i=n.sent,t.footerData=i;case 4:case"end":return n.stop()}}),n)})))()},onClickSearch:function(){var n=this;this.$http.get("/api/v2.0/WeChat/Campaigns/".concat(n.activityId,"/Dishes?dishesTypeId=").concat(n.type,"&skip=").concat(n.skip,"&take=").concat(n.take)).then((function(i){i.data.dishes.length<n.take&&(n.featch=!1),n.dishesTypes=i.data.dishesTypes;var e=n.dishes.concat(i.data.dishes),o={},s=e.reduce((function(t,n){return!o[n.cmpaignDishesId]&&(o[n.cmpaignDishesId]=t.push(n)),t}),[]);n.dishes=s,t.hideNavigationBarLoading()})).catch((function(){t.hideNavigationBarLoading()}))},onChangeType:function(t){var n,i=this;this.dishes.forEach((function(t){if(i.computedNum[t.dishesInfoId]>0){var n={campaignDishesId:t.cmpaignDishesId,quantity:t.count};i.Bookings.push(n)}})),n=this.Bookings,this.type=t,this.skip=0,this.dishes=[],this.onClickSearch(),this.Bookings=n,console.log("检查数组"),console.log(this.Bookings)},addOrDecNum:function(t,n,i){var e=this;for(var o in this.dishes.forEach((function(n){n.dishesInfoId==t&&(e.totalAmount+=i)})),this.computedNum[t]=n,this.dishes){var s=this.dishes[o];s.dishesInfoId==t&&(this.dishes[o].count=n)}},userInfo:function(){var n=this;this.dishes.forEach((function(t){if(n.computedNum[t.dishesInfoId]>0){var i={campaignDishesId:t.cmpaignDishesId,quantity:t.count};n.Bookings.push(i)}}));var i=t.getStorageSync("phoneNumber"),e=this.Bookings;t.showModal({content:"确认要提交您的订单吗?",success:function(o){o.confirm&&n.$http.post("/api/v2.0/WeChat/Bookings",{bookings:e,phoneNum:i}).then((function(i){var o=JSON.stringify(e);t.navigateTo({url:"./sale-activity-order?totalAmount="+n.totalAmount+"&bookings="+o+"&activityId="+n.activityId}),n.computedNum=[],n.Bookings=[],n.totalAmount=0})).catch((function(i){t.showModal({title:"提示",content:"".concat(i.message),success:function(t){}}),n.computedNum=[],n.Bookings=[],n.totalAmount=0}))}})},submit:function(){var n=this;this.dishes.forEach((function(t){if(n.computedNum[t.dishesInfoId]>0){var i={campaignDishesId:t.cmpaignDishesId,quantity:t.count};n.Bookings.push(i)}}));var i=this.Bookings,e=JSON.stringify(i);t.navigateTo({url:"./sale-activity-order?totalAmount="+this.totalAmount+"&bookings="+e+"&activityId="+this.activityId}),this.computedNum=[],this.Bookings=[],this.totalAmount=0}},components:{saleActivityDetailList:function(){i.e("packageWM/components/sale-activity/sale-activity-detal-list").then(function(){return resolve(i("a189"))}.bind(null,i)).catch(i.oe)},returnHome:function(){i.e("components/return-home/return-home").then(function(){return resolve(i("4821"))}.bind(null,i)).catch(i.oe)},customFooter:function(){i.e("components/custom-footer/custom-footer").then(function(){return resolve(i("7d39"))}.bind(null,i)).catch(i.oe)}}};n.default=c}).call(this,i("543d")["default"],i("bc2e")["default"])},"8a7d":function(t,n,i){"use strict";i.d(n,"b",(function(){return e})),i.d(n,"c",(function(){return o})),i.d(n,"a",(function(){}));var e=function(){var t=this.$createElement;this._self._c},o=[]},a131:function(t,n,i){"use strict";(function(t,n){var e=i("4ea4");i("895d");e(i("66fd"));var o=e(i("0d19"));t.__webpack_require_UNI_MP_PLUGIN__=i,n(o.default)}).call(this,i("bc2e")["default"],i("543d")["createPage"])},bb80:function(t,n,i){"use strict";i.r(n);var e=i("5aa3"),o=i.n(e);for(var s in e)["default"].indexOf(s)<0&&function(t){i.d(n,t,(function(){return e[t]}))}(s);n["default"]=o.a}},[["a131","common/runtime","common/vendor"]]]);