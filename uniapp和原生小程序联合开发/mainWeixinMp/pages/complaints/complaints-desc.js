(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/complaints/complaints-desc"],{3877:function(t,e,n){},3881:function(t,e,n){"use strict";n.r(e);var o=n("71fb"),a=n("5ace");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("9b16");var c=n("f0c5"),s=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,"4de18aca",null,!1,o["a"],void 0);e["default"]=s.exports},"5ace":function(t,e,n){"use strict";n.r(e);var o=n("d52b"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},"71fb":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o}));var o={userPrivacy:function(){return n.e("components/userPrivacy/userPrivacy").then(n.bind(null,"594f"))}},a=function(){var t=this,e=t.$createElement,n=(t._self._c,t.baseInfo.attachments&&t.baseInfo.attachments.length>0),o=t.dealItems.length,a=t.__map(t.dealItems,(function(e,n){var o=t.__get_orig(e),a=e.attachments&&e.attachments.length>0;return{$orig:o,g2:a}})),i=t.comments.length,c=t.__map(t.comments,(function(e,n){var o=t.__get_orig(e),a=e.attachments&&e.attachments.length>0;return{$orig:o,g4:a}}));t.$mp.data=Object.assign({},{$root:{g0:n,g1:o,l0:a,g3:i,l1:c}})},i=[]},"9b16":function(t,e,n){"use strict";var o=n("3877"),a=n.n(o);a.a},d52b:function(t,e,n){"use strict";(function(t,o){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;a(n("7037"));var i={name:"approvalDetail",components:{sxRate:function(){Promise.all([n.e("common/vendor"),n.e("components/sx-rate/index")]).then(function(){return resolve(n("0289"))}.bind(null,n)).catch(n.oe)},userPrivacy:function(){n.e("components/userPrivacy/userPrivacy").then(function(){return resolve(n("594f"))}.bind(null,n)).catch(n.oe)}},data:function(){return{id:"",active:"",baseInfo:{},timeId:null,showEvaluationBtn:!1,dealItems:[],comments:[],showPrivacy:!1}},onLoad:function(e){var n=this;t.onNeedPrivacyAuthorization&&t.onNeedPrivacyAuthorization((function(t,e){n.showPrivacy=!0,n.resolvePrivacyAuthorization=t})),console.log("投诉建议详情",e),this.id=e.id,this.active=e.active,this.getDetail(),this.getPermissions()},methods:{agreePrivacy:function(){this.showPrivacy=!1,this.resolvePrivacyAuthorization({buttonId:"agree-btn",event:"agree"})},disagreePrivacy:function(){this.showPrivacy=!1},debounceFn:function(t){this.timeId&&clearTimeout(this.timeId),this.timeId=setTimeout(t,500)},getDetail:function(){var t=this;this.$httpWorkflow.get("/cs_record/".concat(this.id)).then((function(e){if(e&&e.success&&(t.baseInfo=e.result,t.dealItems=e.result.dealItems,t.comments=e.result.comments,null!=t.comments&&t.comments.length>0))for(var n=0;n<t.comments.length;n++)if(t.comments[n].formData){var o=JSON.parse(t.comments[n].formData);o.comment_node.values.evaluations.forEach((function(t){return t.grade=t.grade+1})),o.comment_node.values.commentGrade=o.comment_node.values.commentGrade+1,t.comments[n].formObj=o}})).catch((function(t){console.log(t)}))},getPermissions:function(){var t=this;this.$httpWorkflow.get("/cs_approval/permissions/".concat(this.id)).then((function(e){if(e&&e.success){var n=e.result;if(n.buttons){var o=n.buttons.findIndex((function(t){return"评价"==t.buttonTypeStr}));o>-1&&(t.showEvaluationBtn=!0)}}})).catch((function(t){console.log(t)}))},downloadFile:function(e){o.downloadFile({url:e.url,success:function(n){if(200===n.statusCode){var a=e.name.split("."),i=["jpg","jpeg","png","webp","bmp"].indexOf(a[a.length-1]);if(i>-1){var c=t.env.USER_DATA_PATH+"/"+e.name;t.getFileSystemManager().saveFile({tempFilePath:n.tempFilePath,filePath:c,success:function(e){t.saveImageToPhotosAlbum({filePath:c,success:function(e){t.showModal({title:"文件已保存到手机相册",confirmColor:"#0bc183",confirmText:"知道了",showCancel:!1})},fail:function(t){console.log(t)}})},fail:function(t){console.log(t)}})}else o.saveFile({tempFilePath:n.tempFilePath,success:function(t){console.log("savedFilePath",t.savedFilePath),o.showToast({icon:"none",mask:!0,title:"请点击右上角的..., 下载文件到本地",duration:3e3}),setTimeout((function(){o.openDocument({filePath:t.savedFilePath,showMenu:!0,success:function(t){}})}),1e3)}})}},fail:function(t){console.log("下载失败",t),o.showToast({icon:"none",mask:!0,title:"失败请重新下载"})}})},actionSheetTap:function(t){var e=t,n=this.baseInfo.attachments.map((function(t){return t.filePath}));o.showActionSheet({itemList:["预览"],success:function(t){0==t.tapIndex&&o.previewImage({current:e,urls:n})}})},actionSheetTap1:function(t,e){var n=e,a=t.map((function(t){return t.filePath}));o.showActionSheet({itemList:["预览"],success:function(t){0==t.tapIndex&&o.previewImage({current:n,urls:a})}})},goEvaluation:function(){o.navigateTo({url:"/pages/complaints/complaints-evaluation?id=".concat(this.id)})}}};e.default=i}).call(this,n("bc2e")["default"],n("543d")["default"])},fd5c:function(t,e,n){"use strict";(function(t,e){var o=n("4ea4");n("895d");o(n("66fd"));var a=o(n("3881"));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])}},[["fd5c","common/runtime","common/vendor"]]]);