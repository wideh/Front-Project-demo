(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/me/me"],{"0e86":function(e,t,n){"use strict";(function(e,t){var i=n("4ea4");n("895d");i(n("66fd"));var a=i(n("c583"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"1dab":function(e,t,n){},"1f12":function(e,t,n){"use strict";n.r(t);var i=n("7144"),a=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=a.a},"3e32":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var i={pageStatusBar:function(){return n.e("components/page-status-bar/page-status-bar").then(n.bind(null,"9cf9"))}},a=function(){var e=this,t=e.$createElement,n=(e._self._c,e.getstaticOssUrl("wechat_index/me/new_icon-house.png")),i=e.getstaticOssUrl("wechat_index/me/new_icon-car.png"),a=e.getstaticOssUrl("wechat_index/me/new_icon-parking.png"),o=e.permissionDatas.find((function(t){return t.code==e.permissionData.我的活动})),s=o.approve?e.getstaticOssUrl("wechat_index/me/new_icon-activity.png"):null,r=e.permissionDatas.find((function(t){return t.code==e.permissionData.我的积分})),c=r.approve?e.getstaticOssUrl("wechat_index/me/new_icon-pay.png"):null,u=e.getstaticOssUrl("wechat_index/me/new_icon-approval.png"),l=e.getstaticOssUrl("wechat_index/me/new_icon-phone.png"),h=e.permissionDatas.find((function(t){return t.code==e.permissionData.历史账单})),g=h.approve?e.getstaticOssUrl("wechat_index/me/new_icon-list.png"):null,p=e.permissionDatas.find((function(t){return t.code==e.permissionData.缴费记录})),d=p.approve?e.getstaticOssUrl("wechat_index/me/new_icon-pay.png"):null,f=e.canRecharge&&e.permissionDatas.find((function(t){return t.code==e.permissionData.预缴充值})).approve,m=f?e.getstaticOssUrl("wechat_index/me/new_icon-charge.png"):null,v=e.permissionDatas.find((function(t){return t.code==e.permissionData.我的订单})),b=v.approve?e.getstaticOssUrl("wechat_index/me/new_icon-phone.png"):null,k=e.permissionDatas.find((function(t){return t.code==e.permissionData.意向房源})),w=k.approve?e.getstaticOssUrl("wechat_index/me/new_icon-house.png"):null,T=e.permissionDatas.find((function(t){return t.code==e.permissionData.我的租赁})),_=T.approve?e.getstaticOssUrl("wechat_index/me/new_icon-house.png"):null,y=e.getstaticOssUrl("wechat_index/me/new_icon-about.png");e.$mp.data=Object.assign({},{$root:{m0:n,m1:i,m2:a,g0:o,m3:s,g1:r,m4:c,m5:u,m6:l,g2:h,m7:g,g3:p,m8:d,g4:f,m9:m,g5:v,m10:b,g6:k,m11:w,g7:T,m12:_,m13:y}})},o=[]},"41a2":function(e,t,n){"use strict";var i=n("1dab"),a=n.n(i);a.a},7144:function(e,t,n){"use strict";(function(e,i){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("2eee")),s=a(n("c973")),r=n("1612"),c={components:{pageStatusBar:function(){n.e("components/page-status-bar/page-status-bar").then(function(){return resolve(n("9cf9"))}.bind(null,n)).catch(n.oe)},uniGrid:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-grid/uni-grid").then(function(){return resolve(n("f6dd"))}.bind(null,n)).catch(n.oe)},uniGridItem:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-grid-item/uni-grid-item").then(function(){return resolve(n("591e"))}.bind(null,n)).catch(n.oe)},uniList:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-list/uni-list").then(function(){return resolve(n("d9eb"))}.bind(null,n)).catch(n.oe)},uniListItem:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-list-item/uni-list-item").then(function(){return resolve(n("24a7"))}.bind(null,n)).catch(n.oe)},customFooter:function(){n.e("components/custom-footer/custom-footer").then(function(){return resolve(n("7d39"))}.bind(null,n)).catch(n.oe)}},data:function(){return{position:"",messageCount:20,user:null,debugModel:!1,aboutText:"关于"+this.$config.appName,canRecharge:!0,phone:"",footerData:null,score:null,permissionDatas:[],permissionData:r.permissionData}},computed:{displayMessageCount:function(){return this.messageCount<=99?this.messageCount+"":"99+"},isWeixinOauthLogin:function(){return!(!this.user||!this.user.wechatAuthorizedUserInfo)},isLogin:function(){return!!this.user},displayPhoto:function(){return this.isLogin&&this.user.avatarUrl?this.$tool.image.getHttpUrl(this.user.avatarUrl):this.$tool.image.staticOssHttp+"wechat-static/photo.png"}},onLoad:function(){this.debugModel=!1,e.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]})},onShow:function(){if("function"===typeof this.$mp.page.getTabBar&&this.$mp.page.getTabBar()){this.$mp.page.getTabBar().updatePermissionData();var e=this.$mp.page.getTabBar().data.list,t=e.findIndex((function(e){return e.text===r.tabBarNameData.我的}));this.$mp.page.getTabBar().setData({selected:t})}i.showLoading({title:"加载中"});var n=this,a=i.getStorageSync(n.$config.storageKeys.user);a.nickName&&a.avatarUrl&&n.$http.post("api/v2.0/wechat-mini-program-oauth/syncuserinfo",{openId:i.getStorageSync(n.$config.storageKeys.openId),NickName:a.nickName,AvatarUrl:a.avatarUrl,UnionId:""}),n.$http.get("/api/v2.0/wechat/authorized-users/me").then((function(e){i.setStorageSync(n.$config.storageKeys.user,e),n.user=e,n.$http.get("/api/v2.0/weChat/user-resources/me").then((function(e){if(n.canRecharge=!0,e.length>0){var t=e.filter((function(e){return 5==e.itemType})),i=e.filter((function(e){return 7==e.itemType}));0==i.length&&t.length>0&&t.every((function(e){return"租户"==e.relationTypeName}))&&(n.canRecharge=!1)}n.$httpHd.get("/nova-mall-api/p/score/scoreInfo").then((function(e){n.score=e.score?e.score:null}))})).catch((function(e){console.log(e.Message)})),i.hideLoading()})).catch((function(e){i.hideLoading(),console.log(e)}));var o=i.getStorageSync(n.$config.storageKeys.community);n.$http.get("/api/v2.0/weChat/regions/".concat(o.id,"/phone")).then((function(e){n.phone=e}));var s=i.getStorageSync(n.$config.storageKeys.permissionDatasId);this.permissionDatas=s,this.getFooterData()},onShareAppMessage:function(e){if("menu"===e.from)return{title:"".concat(this.$config.appName),path:"/pages/index/index",imageUrl:""}},onShareTimeline:function(){return{title:"".concat(this.$config.appName),path:"/pages/index/index",imageUrl:""}},methods:{checkIsLogin:function(){return!!this.isLogin||(i.showToast({icon:"none",title:"还没登录"}),!1)},checkBindTelephone:function(){var e=this;if(this.checkIsLogin()){if(this.user.phoneNumber)return!0;i.showModal({title:"请先完成手机绑定",confirmText:"去绑定",success:function(t){t.confirm&&(e.isWeixinOauthLogin?i.navigateTo({url:"../login/check/check"}):i.navigateTo({url:"../login/weixin/weixin"}))}})}return!1},checkHasRoom:function(){if(this.checkBindTelephone()){if(this.user.defaultHouseResourceId)return!0;i.showModal({title:"还没有添加任何房间",confirmText:"去添加",success:function(e){e.confirm&&i.navigateTo({url:"room/room"})}})}return!1},onGridItemClick:function(e){if(this.checkBindTelephone())switch(e.detail.index){case 0:i.navigateTo({url:"room/room"});break;case 1:i.navigateTo({url:"car/car"});break;case 2:i.navigateTo({url:"parking/parking"});break;case 3:i.navigateTo({url:"activity/activity"});break;default:break}},onTopInfoClick:function(){this.isWeixinOauthLogin?i.navigateTo({url:"setting/setting"}):i.navigateTo({url:"../login/weixin/weixin"})},onMenuListClick:function(e){switch(e){case 0:break;case 1:this.phone?i.makePhoneCall({phoneNumber:this.phone}):i.showToast({icon:"none",title:"亲爱的业主：电话号码修改中，暂时无法显示，请耐心等待！",duration:2e3});break;case 2:break;case 3:this.checkHasRoom()&&i.navigateTo({url:"history-bill/history-bill"});break;case 4:this.checkHasRoom()&&i.navigateTo({url:"history-pay/history-pay"});break;case 5:this.checkHasRoom()&&i.navigateTo({url:"../me/select/room-and-parking/room-and-parking?selectType=both&returnUrl=/pages/me/recharge/recharge"});break;case 6:i.navigateTo({url:"../about/about"});break;case 7:i.navigateTo({url:"debug-page/debug-page"});break;case 8:i.navigateTo({url:"/packageEC/my-order"});break;case 9:i.navigateTo({url:"/packageZS/house-resource-suppose-list"});break;case 11:if(!this.checkTelephoneAndSavaShopId())break;this.checkIsLogin()&&this.checkBindTelephone()&&i.navigateTo({url:"/pages/nova-mall/pointWeb"});break;case 10:i.navigateTo({url:"/packagePark/MyBusiness/business/business"});break;case 12:i.navigateTo({url:"/packageForm/applyList/applyList"});break;case 13:this.checkHasResouce()&&i.navigateTo({url:"/packageBill/myLease/contract-list"});break;default:break}},callPhone:function(){var e=this;return new Promise((function(t,n){i.showModal({title:"确认拨打该电话吗？",content:e.phone,success:function(e){e.confirm?t(!0):t(!1)}})}))},getFooterData:function(){var e=this;return(0,s.default)(o.default.mark((function t(){var n;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$footerConfig.get();case 2:n=t.sent,e.footerData=n;case 4:case"end":return t.stop()}}),t)})))()},checkHasResouce:function(){if(this.checkBindTelephone()){if(this.user.defaultResourceId)return!0;i.showModal({title:"还没有添加任何房间车位",confirmText:"去添加",success:function(e){e.confirm&&i.navigateTo({url:"../me/room/room"})}})}return!1},getstaticOssUrl:function(e){return e?this.$tool.image.getstaticOssUrl(e):""},checkTelephoneAndSavaShopId:function(){if(this.checkBindTelephone()){var e=this;return this.$httpHd.get("/nova-mall-api/p/shopDetail/getSaasShopId").then((function(t){i.setStorageSync(e.$config.storageKeys.shopId,t)})),!0}return!1}}};t.default=c}).call(this,n("bc2e")["default"],n("543d")["default"])},c583:function(e,t,n){"use strict";n.r(t);var i=n("3e32"),a=n("1f12");for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n("41a2");var s=n("f0c5"),r=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);t["default"]=r.exports}},[["0e86","common/runtime","common/vendor"]]]);