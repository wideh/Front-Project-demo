(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/me/room/add/add"],{4302:function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("895d");o(n("66fd"));var r=o(n("ce4c"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},6805:function(e,t,n){"use strict";n.r(t);var o=n("f09a"),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},"814a":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"cff5"))}},r=function(){var e=this.$createElement;this._self._c},a=[]},bd9d:function(e,t,n){"use strict";var o=n("e3bb"),r=n.n(o);r.a},ce4c:function(e,t,n){"use strict";n.r(t);var o=n("814a"),r=n("6805");for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n("bd9d");var i=n("f0c5"),c=Object(i["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=c.exports},e3bb:function(e,t,n){},f09a:function(e,t,n){"use strict";(function(e){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=o(n("2eee")),a=o(n("c973")),i={components:{uniIcons:function(){Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(function(){return resolve(n("1533"))}.bind(null,n)).catch(n.oe)},customFooter:function(){n.e("components/custom-footer/custom-footer").then(function(){return resolve(n("7d39"))}.bind(null,n)).catch(n.oe)}},data:function(){return{roomId:"",role:"",name:"",phone:"",code:"",correctCode:"",timer:60,relationType:0,member:"",members:["父母","夫妻","子女","亲戚","朋友"],codeBtnDisabled:!1,submitBtnDisabled:!1,submitBtnText:"下一步",text:"获取验证码",errorText:"",footerData:null}},onLoad:function(e){this.role=e.role,"owner"==this.role&&(this.submitBtnText="提交")},onShow:function(){var t=e.getStorageSync(this.$config.storageKeys.room);t&&t.id&&(this.roomId=t.id),this.getFooterData()},methods:{setCodeBtn:function(){var e=this;e.codeBtnDisabled=!0,e.text=e.timer;var t=setInterval((function(){if(e.timer--,e.text=e.timer,0==e.timer)return clearInterval(t),e.timer=60,e.codeBtnDisabled=!1,void(e.text="获取验证码")}),1e3)},validatePhone:function(){var t=1*this.phone;return!(t<1e10||this.phone>19999999999)||(e.showToast({title:"手机号不符合要求",duration:2e3,icon:"none"}),!1)},sendCode:function(){var e=this;e.validatePhone()&&e.$http.request("/api/v2.0/weChat/sms/send",{phone:e.phone,type:2},{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST"}).then((function(t){e.setCodeBtn()})).catch((function(t){e.errorText=t.message,console.log(t)}))},validateCode:function(){var e=this;return new Promise((function(t,n){e.$http.request("/api/v2.0/weChat/sms/validate",{phone:e.phone,type:2,code:e.code},{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST"}).then((function(e){t(!0)})).catch((function(n){e.errorText=n.message,console.log(n),t(!1)}))}))},validate:function(){var t=this;return(0,a.default)(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t,o.errorText="",o.roomId){n.next=5;break}return e.showToast({title:"请选择房间",icon:"none"}),n.abrupt("return",!1);case 5:if(o.name){n.next=8;break}return e.showToast({title:"请输入姓名",icon:"none"}),n.abrupt("return",!1);case 8:if("member"!=o.role||o.member){n.next=11;break}return e.showToast({title:"请选择家庭角色",icon:"none"}),n.abrupt("return",!1);case 11:if(o.validatePhone()){n.next=13;break}return n.abrupt("return",!1);case 13:return n.abrupt("return",!0);case 14:case"end":return n.stop()}}),n)})))()},check:function(){var t=this;return(0,a.default)(r.default.mark((function n(){var o;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t,o.submitBtnDisabled=!0,n.next=4,o.validate();case 4:if(!n.sent){n.next=8;break}"owner"==o.role?(e.showLoading({title:"认证中",mask:!0}),o.$http.request("/api/v2.0/wechat/house-owners/authenticate",{organizationItemId:o.roomId,name:o.name,phone:o.phone},{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST"}).then((function(t){e.hideLoading(),o.submitBtnDisabled=!1,e.navigateTo({url:"../add-success/add-success?role=".concat(o.role)})})).catch((function(t){e.hideLoading(),o.submitBtnDisabled=!1,console.log(t),o.errorText=t.message}))):(e.hideLoading(),o.submitBtnDisabled=!1,e.navigateTo({url:"../check-owner/check-owner?role=".concat(o.role,"&roomId=").concat(o.roomId,"&name=").concat(o.name,"&phone=").concat(o.phone,"&relationType=").concat(o.relationType)})),n.next=9;break;case 8:o.submitBtnDisabled=!1;case 9:case"end":return n.stop()}}),n)})))()},bindPickerChange:function(e){this.relationType=1*e.target.value+1,this.member=this.members[e.target.value]},getFooterData:function(){var e=this;return(0,a.default)(r.default.mark((function t(){var n;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$footerConfig.get();case 2:n=t.sent,e.footerData=n;case 4:case"end":return t.stop()}}),t)})))()}}};t.default=i}).call(this,n("543d")["default"])}},[["4302","common/runtime","common/vendor"]]]);