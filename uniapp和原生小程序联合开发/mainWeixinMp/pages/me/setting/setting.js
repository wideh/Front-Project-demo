(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/me/setting/setting"],{"0967":function(e,t,n){"use strict";n.r(t);var o=n("09f9"),a=n("89b4");for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);n("a990");var r=n("f0c5"),c=Object(r["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=c.exports},"09f9":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o}));var o={uniIcons:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(n.bind(null,"cff5"))},userPrivacy:function(){return n.e("components/userPrivacy/userPrivacy").then(n.bind(null,"594f"))}},a=function(){var e=this.$createElement;this._self._c},i=[]},"0fac":function(e,t,n){"use strict";(function(e,t){var o=n("4ea4");n("895d");o(n("66fd"));var a=o(n("0967"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n("bc2e")["default"],n("543d")["createPage"])},"89b4":function(e,t,n){"use strict";n.r(t);var o=n("989e"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(i);t["default"]=a.a},"8c0b":function(e,t,n){},"989e":function(e,t,n){"use strict";(function(e,o){var a=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("2eee")),r=a(n("c973")),c={components:{uniCard:function(){n.e("node-modules/@dcloudio/uni-ui/lib/uni-card/uni-card").then(function(){return resolve(n("ac4d"))}.bind(null,n)).catch(n.oe)},uniIcons:function(){Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons")]).then(function(){return resolve(n("1533"))}.bind(null,n)).catch(n.oe)},customFooter:function(){n.e("components/custom-footer/custom-footer").then(function(){return resolve(n("7d39"))}.bind(null,n)).catch(n.oe)},userPrivacy:function(){n.e("components/userPrivacy/userPrivacy").then(function(){return resolve(n("594f"))}.bind(null,n)).catch(n.oe)}},data:function(){return{name:"",defaultResourceName:"",nickname:"",array:[{name:"女"},{name:"男"}],sex:0,phone:"",birthday:"",date:"",endDate:"",photo:"https://pms-statics.oss-cn-shenzhen.aliyuncs.com/wechat-static/me/default-user-photo.png",footerData:null,showPrivacy:!1}},onLoad:function(){var t=this;e.onNeedPrivacyAuthorization&&e.onNeedPrivacyAuthorization((function(e,n){t.showPrivacy=!0,t.resolvePrivacyAuthorization=e}))},onShow:function(){this.init(),this.getFooterData()},methods:{agreePrivacy:function(){this.showPrivacy=!1,this.resolvePrivacyAuthorization({buttonId:"agree-btn",event:"agree"})},disagreePrivacy:function(){this.showPrivacy=!1},init:function(){var e=this;e.$http.get("/api/v2.0/wechat/authorized-users/me").then((function(t){e.defaultResourceName=t.defaultResourceName,e.photo=t.avatarUrl,e.sex=t.sex,e.nickname=t.nickName||"未设置",e.phone=t.phoneNumber||"未绑定",e.date=e.displayDate(t.birthday),e.photo=e.$tool.image.getHttpUrl(t.avatarUrl),e.endDate=e.$tool.date.format(new Date,"yyyy-MM-dd")})).catch((function(e){console.log(e)}))},uploadImg:function(){var e=this,t=o.getStorageSync(e.$config.storageKeys.token);o.chooseImage({count:1,sizeType:["original","compressed"],success:function(n){o.showLoading({title:"上传图片中"}),o.uploadFile({url:e.$config.apiWYBaseUrl+"/api/v2.0/weChat/application-users/me/avatarurl",filePath:n.tempFilePaths[0],name:"avatar",formData:{user:"test"},header:{"Content-Type":"multipart/form-data",Authorization:t.token_type+" "+t.access_token},success:function(t){var n=JSON.parse(t.data);if(n.success){e.photo=e.$tool.image.getHttpUrl(n.result.avatarUrl);var a=o.getStorageSync(e.$config.storageKeys.user);a.avatarUrl=e.photo,o.setStorageSync(e.$config.storageKeys.user,a)}o.showToast({title:"上传成功"})},fail:function(e){o.showToast({title:"上传失败"}),console.log(e)}})}})},editNickname:function(){o.navigateTo({url:"../nickname/nickname?nickname="+encodeURIComponent(this.nickname)})},editPhone:function(){o.navigateTo({url:"../phone/phone"})},bindSexChange:function(e){this.sex=e.target.value,this.$http.request("/api/v2.0/weChat/application-users/me/sex",{sex:this.sex},{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"PUT"}).then((function(e){o.showToast({title:"更新成功"})})).catch((function(e){console.log(e)}))},bindDateChange:function(e){this.date=e.target.value,this.$http.request("/api/v2.0/weChat/application-users/me/birthday",{birthday:this.date},{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"PUT"}).then((function(e){o.showToast({title:"更新成功"})})).catch((function(e){console.log(e)}))},displayDate:function(e){return null==e?"去设置":this.$tool.date.format(e,"yyyy-MM-dd")},goToUserCenter:function(){o.switchTab({url:"../me"})},getFooterData:function(){var e=this;return(0,r.default)(i.default.mark((function t(){var n;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$footerConfig.get();case 2:n=t.sent,e.footerData=n;case 4:case"end":return t.stop()}}),t)})))()}}};t.default=c}).call(this,n("bc2e")["default"],n("543d")["default"])},a990:function(e,t,n){"use strict";var o=n("8c0b"),a=n.n(o);a.a}},[["0fac","common/runtime","common/vendor"]]]);